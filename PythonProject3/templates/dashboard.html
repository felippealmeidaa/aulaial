<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - IAUniev</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¤–</text></svg>">

    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css' rel='stylesheet' />

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- ============================================ -->
    <!-- NAVBAR COM CARDS DE SINCRONIZAÃ‡ÃƒO -->
    <!-- ============================================ -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="logo">ğŸ¤–</span>
            <h2>IAUniev</h2>
        </div>

        <!-- ğŸ†• CARDS DE SINCRONIZAÃ‡ÃƒO NO TOPO -->
        <div class="sync-cards-header">
            <!-- Card AVA -->
            <div class="sync-card-mini" id="syncCardMiniAVA" onclick="abrirModalSync('ava')" title="Clique para sincronizar AVA">
                <div class="sync-card-mini-icon">ğŸ”„</div>
                <div class="sync-card-mini-content">
                    <div class="sync-card-mini-title">AVA</div>
                    <div class="sync-card-mini-status" id="statusMiniAVA">
                        <span class="sync-loading-mini">Verificando...</span>
                    </div>
                </div>
            </div>

            <!-- Card Lyceum -->
            <div class="sync-card-mini" id="syncCardMiniLyceum" onclick="abrirModalSync('lyceum')" title="Clique para sincronizar Lyceum">
                <div class="sync-card-mini-icon">ğŸ“Š</div>
                <div class="sync-card-mini-content">
                    <div class="sync-card-mini-title">Lyceum</div>
                    <div class="sync-card-mini-status" id="statusMiniLyceum">
                        <span class="sync-loading-mini">Verificando...</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="nav-menu">
            <a href="#" class="nav-link active" data-section="chat" onclick="showSection('chat', this)">
                <span>ğŸ’¬</span> Chat IA
            </a>
            <a href="#" class="nav-link" data-section="comunidade" onclick="showSection('comunidade', this)">
                <span>ğŸ‘¥</span> Comunidade
            </a>
            <a href="#" class="nav-link" data-section="calendario" onclick="showSection('calendario', this)">
                <span>ğŸ“…</span> CalendÃ¡rio
            </a>
            <a href="#" class="nav-link" data-section="perfil" onclick="showSection('perfil', this)">
                <span>ğŸ‘¤</span> Meu Perfil
            </a>

            <button class="nav-link dark-mode-toggle" onclick="toggleDarkMode()" title="Alternar modo escuro">
                <span class="dark-icon">ğŸŒ™</span>
                <span class="light-icon" style="display:none;">â˜€ï¸</span>
                <span class="nav-text">Modo</span>
            </button>

            <div class="notif-container">
                <button class="notif-btn" onclick="toggleNotificacoes()" title="NotificaÃ§Ãµes">
                    ğŸ””
                    <span id="notif-badge" class="notif-badge" style="display: none;">0</span>
                </button>
                <div id="notif-dropdown" class="notif-dropdown" style="display: none;">
                    <div class="notif-header">
                        <h3>ğŸ“¬ NotificaÃ§Ãµes</h3>
                        <button onclick="marcarTodasLidas()" class="btn-mark-read">Marcar todas como lidas</button>
                    </div>
                    <div id="notif-list" class="notif-list">
                        <div class="notif-empty">Carregando...</div>
                    </div>
                </div>
            </div>

            <a href="/logout" class="nav-link logout">
                <span>ğŸšª</span> Sair
            </a>
        </div>
    </nav>

    <!-- ============================================ -->
    <!-- MODAL DE SINCRONIZAÃ‡ÃƒO (AVA E LYCEUM) -->
    <!-- ============================================ -->
    <div id="modalSync" class="modal-sync" style="display: none;">
        <div class="modal-sync-content">
            <span class="modal-sync-close" onclick="fecharModalSync()">&times;</span>

            <!-- Modal AVA -->
            <div id="modalSyncAVA" class="modal-sync-body" style="display: none;">
                <h2>ğŸ”„ Sincronizar com AVA</h2>
                <p class="modal-sync-desc">Baixa materiais, vÃ­deos e PDFs das disciplinas</p>

                <div id="syncStatusAVAModal" class="sync-status-modal">
                    <div id="syncStatusContentAVAModal">
                        <p><strong id="statusTitleAVAModal">Verificando...</strong></p>
                        <p id="statusTextAVAModal">Carregando informaÃ§Ãµes...</p>
                    </div>
                </div>

                <button id="syncBtnAVAModal" class="btn-sync-modal" onclick="iniciarSincronizacao()" disabled>
                    <span id="syncBtnTextAVAModal">Sincronizar Agora</span>
                </button>

                <div id="syncProgressContainerAVAModal" class="sync-progress-modal" style="display: none;">
                    <div class="sync-progress-bar-modal"></div>
                </div>

                <p class="modal-sync-info">â±ï¸ Tempo estimado: <strong>5-8 minutos</strong></p>
            </div>

            <!-- Modal Lyceum -->
            <div id="modalSyncLyceum" class="modal-sync-body" style="display: none;">
                <h2>ğŸ“Š Sincronizar com Lyceum</h2>
                <p class="modal-sync-desc">Baixa notas oficiais (VA1, VA2, VA3) e faltas</p>

                <div id="syncStatusLyceumModal" class="sync-status-modal">
                    <div id="syncStatusContentLyceumModal">
                        <p><strong id="statusTitleLyceumModal">Verificando...</strong></p>
                        <p id="statusTextLyceumModal">Carregando informaÃ§Ãµes...</p>
                    </div>
                </div>

                <button id="syncBtnLyceumModal" class="btn-sync-modal" onclick="iniciarSincronizacaoLyceum()" disabled>
                    <span id="syncBtnTextLyceumModal">Sincronizar Agora</span>
                </button>

                <div id="syncProgressContainerLyceumModal" class="sync-progress-modal" style="display: none;">
                    <div class="sync-progress-bar-modal"></div>
                </div>

                <p class="modal-sync-info">â±ï¸ Tempo estimado: <strong>2-3 minutos</strong></p>
                <p class="modal-sync-info">ğŸ” Senha: <strong>9 primeiros dÃ­gitos do CPF</strong></p>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- SEÃ‡Ã•ES DO DASHBOARD -->
    <!-- ============================================ -->
    <section id="chat" class="section active">
        <div class="section-header">
            <h1>ğŸ’¬ Chat com Assistente IA</h1>
            <p>Tire suas dÃºvidas sobre o curso, materiais e muito mais!</p>
        </div>

        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="message bot-message">
                    <div class="message-content">
                        <p>OlÃ¡, <strong>{{ nome }}</strong>! ğŸ˜Š</p>
                        <p>Sou o assistente virtual da <strong>IAUniev</strong>. Como posso ajudar vocÃª hoje?</p>
                        <p>VocÃª pode me perguntar sobre:</p>
                        <ul>
                            <li>ğŸ“š Materiais de aula e conteÃºdos</li>
                            <li>ğŸ“ Notas e faltas</li>
                            <li>ğŸ“… CalendÃ¡rio acadÃªmico</li>
                            <li>â“ DÃºvidas sobre disciplinas</li>
                            <li>ğŸ¯ E muito mais!</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="chat-actions">
                <button class="btn-action" onclick="carregarHistoricoChat()" title="Carregar histÃ³rico">
                    ğŸ“œ HistÃ³rico
                </button>
                <button class="btn-action" onclick="limparHistoricoChat()" title="Limpar conversa">
                    ğŸ—‘ï¸ Limpar
                </button>
            </div>

            <form id="chatForm" class="chat-input">
                <div class="chat-input-wrapper">
                    <!-- BotÃ£o de anexo -->
                    <button type="button" class="btn-attach" onclick="toggleAttachMenu()" title="Anexar arquivo ou link">
                        ğŸ“
                    </button>

                    <!-- Menu de anexos -->
                    <div id="attachMenu" class="attach-menu" style="display: none;">
                        <button type="button" class="attach-option" onclick="document.getElementById('fileInput').click()">
                            ğŸ“„ Enviar PDF/Documento
                        </button>
                        <button type="button" class="attach-option" onclick="toggleYouTubeInput()">
                            ğŸ¥ Link do YouTube
                        </button>
                    </div>

                    <!-- Input de arquivo (escondido) -->
                    <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.txt" style="display: none;" onchange="handleFileSelect(event)">

                    <!-- Container de anexo selecionado -->
                    <div id="attachmentPreview" class="attachment-preview" style="display: none;">
                        <div class="attachment-info">
                            <span id="attachmentIcon">ğŸ“„</span>
                            <span id="attachmentName">arquivo.pdf</span>
                            <button type="button" class="btn-remove-attachment" onclick="removeAttachment()">Ã—</button>
                        </div>
                    </div>

                    <!-- Input de link do YouTube (escondido inicialmente) -->
                    <div id="youtubeInputContainer" class="youtube-input-container" style="display: none;">
                        <input type="text" id="youtubeLink" class="youtube-link-input" placeholder="Cole o link do YouTube aqui...">
                        <button type="button" class="btn-load-youtube" onclick="loadYouTubeVideo()">Carregar</button>
                        <button type="button" class="btn-cancel-youtube" onclick="cancelYouTube()">Cancelar</button>
                    </div>

                    <!-- Input de mensagem -->
                    <label for="chatInput" style="display:none;">Mensagem do chat</label>
                    <input type="text" id="chatInput" placeholder="Digite sua mensagem..." required autocomplete="off">

                    <button type="submit" class="btn-send">
                        â¤ Enviar
                    </button>
                </div>
            </form>
        </div>
    </section>

    <section id="comunidade" class="section">
        <div class="section-header">
            <h1>ğŸ‘¥ Comunidade AcadÃªmica</h1>
            <p>Conecte-se com outros estudantes, compartilhe projetos e tire dÃºvidas!</p>
        </div>

        <div class="comunidade-container">
            <div class="curso-tabs">
                <button class="curso-tab active" data-curso="ia" onclick="showCurso('ia', this)">
                    ğŸ¤– InteligÃªncia Artificial
                </button>
                <button class="curso-tab" data-curso="ads" onclick="showCurso('ads', this)">
                    ğŸ“Š AnÃ¡lise e Desenvolvimento de Sistemas
                </button>
                <button class="curso-tab" data-curso="es" onclick="showCurso('es', this)">
                    âš™ï¸ Engenharia de Software
                </button>
            </div>

            <div id="curso-ia" class="curso-content active">
                <div class="curso-header">
                    <h2>ğŸ¤– InteligÃªncia Artificial</h2>
                    <button class="btn-create-post" onclick="openCreatePostModal('ia')">
                        â• Novo Post
                    </button>
                </div>

                <div class="search-filter-bar">
                    <label for="searchPosts-ia" style="display:none;">Buscar posts</label>
                    <input type="text" id="searchPosts-ia" class="search-input"
                           placeholder="ğŸ” Buscar por tÃ­tulo, conteÃºdo ou tags..."
                           oninput="filtrarPosts()">
                    <label for="filterTipo-ia" style="display:none;">Filtrar por tipo</label>
                    <select id="filterTipo-ia" class="filter-select" onchange="filtrarPosts()">
                        <option value="">Todos os tipos</option>
                        <option value="projeto">ğŸ“Œ Projetos</option>
                        <option value="duvida">â“ DÃºvidas</option>
                        <option value="discussao">ğŸ’¡ DiscussÃµes</option>
                    </select>
                </div>

                <div class="community-grid">
                    {% if posts_ia %}
                        {% for post in posts_ia %}
                        <div class="post-card" data-post-id="{{ post.post_id }}">
                            <div class="post-header">
                                <div class="user-info">
                                    <div class="avatar">ğŸ‘¨â€ğŸ’»</div>
                                    <div>
                                        <h4>{{ post.nome_usuario }}</h4>
                                        <span class="post-time">{{ post.data }}</span>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span class="post-tag {{ post.tipo }}">
                                        {% if post.tipo == 'projeto' %}ğŸ“Œ Projeto
                                        {% elif post.tipo == 'duvida' %}â“ DÃºvida
                                        {% else %}ğŸ’¡ DiscussÃ£o{% endif %}
                                    </span>
                                    {% if post.e_meu %}
                                    <button class="btn-delete-post" onclick="deletePost(this, '{{ post.post_id }}')" title="Excluir post">
                                        ğŸ—‘ï¸
                                    </button>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="post-content">
                                <h3>{{ post.titulo }}</h3>
                                <p>{{ post.conteudo }}</p>
                                {% if post.tags %}
                                <div class="post-tags">ğŸ·ï¸ {{ post.tags }}</div>
                                {% endif %}
                            </div>

                            <div class="post-footer">
                                <button class="post-action like-btn" onclick="likePost(this)">
                                    ğŸ‘ <span class="like-count">0</span> curtidas
                                </button>
                                <button class="post-action comment-btn" onclick="toggleComments(this)">
                                    ğŸ’¬ <span class="comment-count">0</span> comentÃ¡rios
                                </button>
                            </div>

                            <div class="comments-section" style="display: none;">
                                <div class="comments-list"></div>
                                <div class="comment-input">
                                    <label for="comment-field-{{ post.post_id }}" style="display:none;">ComentÃ¡rio</label>
                                    <input type="text" id="comment-field-{{ post.post_id }}" class="comment-field" placeholder="Escreva um comentÃ¡rio...">
                                    <button class="btn-comment" onclick="addComment(this)">Enviar</button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-posts">ğŸ“­ Nenhum post ainda. Seja o primeiro a postar!</p>
                    {% endif %}
                </div>
            </div>

            <div id="curso-ads" class="curso-content">
                <div class="curso-header">
                    <h2>ğŸ“Š AnÃ¡lise e Desenvolvimento de Sistemas</h2>
                    <button class="btn-create-post" onclick="openCreatePostModal('ads')">
                        â• Novo Post
                    </button>
                </div>

                <div class="search-filter-bar">
                    <label for="searchPosts-ads" style="display:none;">Buscar posts</label>
                    <input type="text" id="searchPosts-ads" class="search-input"
                           placeholder="ğŸ” Buscar por tÃ­tulo, conteÃºdo ou tags..."
                           oninput="filtrarPosts()">
                    <label for="filterTipo-ads" style="display:none;">Filtrar por tipo</label>
                    <select id="filterTipo-ads" class="filter-select" onchange="filtrarPosts()">
                        <option value="">Todos os tipos</option>
                        <option value="projeto">ğŸ“Œ Projetos</option>
                        <option value="duvida">â“ DÃºvidas</option>
                        <option value="discussao">ğŸ’¡ DiscussÃµes</option>
                    </select>
                </div>

                <div class="community-grid">
                    {% if posts_ads %}
                        {% for post in posts_ads %}
                        <div class="post-card" data-post-id="{{ post.post_id }}">
                            <div class="post-header">
                                <div class="user-info">
                                    <div class="avatar">ğŸ“Š</div>
                                    <div>
                                        <h4>{{ post.nome_usuario }}</h4>
                                        <span class="post-time">{{ post.data }}</span>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span class="post-tag {{ post.tipo }}">
                                        {% if post.tipo == 'projeto' %}ğŸ“Œ Projeto
                                        {% elif post.tipo == 'duvida' %}â“ DÃºvida
                                        {% else %}ğŸ’¡ DiscussÃ£o{% endif %}
                                    </span>
                                    {% if post.e_meu %}
                                    <button class="btn-delete-post" onclick="deletePost(this, '{{ post.post_id }}')" title="Excluir post">
                                        ğŸ—‘ï¸
                                    </button>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="post-content">
                                <h3>{{ post.titulo }}</h3>
                                <p>{{ post.conteudo }}</p>
                                {% if post.tags %}
                                <div class="post-tags">ğŸ·ï¸ {{ post.tags }}</div>
                                {% endif %}
                            </div>

                            <div class="post-footer">
                                <button class="post-action like-btn" onclick="likePost(this)">
                                    ğŸ‘ <span class="like-count">0</span> curtidas
                                </button>
                                <button class="post-action comment-btn" onclick="toggleComments(this)">
                                    ğŸ’¬ <span class="comment-count">0</span> comentÃ¡rios
                                </button>
                            </div>

                            <div class="comments-section" style="display: none;">
                                <div class="comments-list"></div>
                                <div class="comment-input">
                                    <label for="comment-field-ads-{{ post.post_id }}" style="display:none;">ComentÃ¡rio</label>
                                    <input type="text" id="comment-field-ads-{{ post.post_id }}" class="comment-field" placeholder="Escreva um comentÃ¡rio...">
                                    <button class="btn-comment" onclick="addComment(this)">Enviar</button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-posts">ğŸ“­ Nenhum post ainda. Seja o primeiro a postar!</p>
                    {% endif %}
                </div>
            </div>

            <div id="curso-es" class="curso-content">
                <div class="curso-header">
                    <h2>âš™ï¸ Engenharia de Software</h2>
                    <button class="btn-create-post" onclick="openCreatePostModal('es')">
                        â• Novo Post
                    </button>
                </div>

                <div class="search-filter-bar">
                    <label for="searchPosts-es" style="display:none;">Buscar posts</label>
                    <input type="text" id="searchPosts-es" class="search-input"
                           placeholder="ğŸ” Buscar por tÃ­tulo, conteÃºdo ou tags..."
                           oninput="filtrarPosts()">
                    <label for="filterTipo-es" style="display:none;">Filtrar por tipo</label>
                    <select id="filterTipo-es" class="filter-select" onchange="filtrarPosts()">
                        <option value="">Todos os tipos</option>
                        <option value="projeto">ğŸ“Œ Projetos</option>
                        <option value="duvida">â“ DÃºvidas</option>
                        <option value="discussao">ğŸ’¡ DiscussÃµes</option>
                    </select>
                </div>

                <div class="community-grid">
                    {% if posts_es %}
                        {% for post in posts_es %}
                        <div class="post-card" data-post-id="{{ post.post_id }}">
                            <div class="post-header">
                                <div class="user-info">
                                    <div class="avatar">âš™ï¸</div>
                                    <div>
                                        <h4>{{ post.nome_usuario }}</h4>
                                        <span class="post-time">{{ post.data }}</span>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span class="post-tag {{ post.tipo }}">
                                        {% if post.tipo == 'projeto' %}ğŸ“Œ Projeto
                                        {% elif post.tipo == 'duvida' %}â“ DÃºvida
                                        {% else %}ğŸ’¡ DiscussÃ£o{% endif %}
                                    </span>
                                    {% if post.e_meu %}
                                    <button class="btn-delete-post" onclick="deletePost(this, '{{ post.post_id }}')" title="Excluir post">
                                        ğŸ—‘ï¸
                                    </button>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="post-content">
                                <h3>{{ post.titulo }}</h3>
                                <p>{{ post.conteudo }}</p>
                                {% if post.tags %}
                                <div class="post-tags">ğŸ·ï¸ {{ post.tags }}</div>
                                {% endif %}
                            </div>

                            <div class="post-footer">
                                <button class="post-action like-btn" onclick="likePost(this)">
                                    ğŸ‘ <span class="like-count">0</span> curtidas
                                </button>
                                <button class="post-action comment-btn" onclick="toggleComments(this)">
                                    ğŸ’¬ <span class="comment-count">0</span> comentÃ¡rios
                                </button>
                            </div>

                            <div class="comments-section" style="display: none;">
                                <div class="comments-list"></div>
                                <div class="comment-input">
                                    <label for="comment-field-es-{{ post.post_id }}" style="display:none;">ComentÃ¡rio</label>
                                    <input type="text" id="comment-field-es-{{ post.post_id }}" class="comment-field" placeholder="Escreva um comentÃ¡rio...">
                                    <button class="btn-comment" onclick="addComment(this)">Enviar</button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-posts">ğŸ“­ Nenhum post ainda. Seja o primeiro a postar!</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <section id="calendario" class="section">
        <div class="section-header">
            <h1>ğŸ“… CalendÃ¡rio AcadÃªmico</h1>
            <p>Acompanhe eventos, provas e feriados</p>
        </div>

        <div class="calendario-container">
            <div class="calendar-header">
                <button class="btn-add-event" onclick="openEventModal()">
                    â• Adicionar Evento Pessoal
                </button>
            </div>

            <div id="calendar"></div>

            <div class="calendar-legend">
                <h3>ğŸ“Œ Legenda</h3>
                <div class="legend-items">
                    <div class="legend-item">
                        <span class="legend-color" style="background: #dc3545;"></span>
                        <span>Provas e AvaliaÃ§Ãµes</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #e63946;"></span>
                        <span>Feriados</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #4a90e2;"></span>
                        <span>Eventos AcadÃªmicos</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #28a745;"></span>
                        <span>Eventos Importantes</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background: #ffc107;"></span>
                        <span>Datas Comemorativas</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="perfil" class="section">
        <div class="section-header">
            <h1>ğŸ‘¤ Meu Perfil AcadÃªmico</h1>
            <p>Visualize suas notas, faltas e horÃ¡rios</p>
        </div>

        <div class="perfil-container">
            <div class="perfil-tabs">
                <button class="perfil-tab active" data-tab="notas" onclick="showPerfilTab('notas', this)">
                    ğŸ“Š Notas
                </button>
                <button class="perfil-tab" data-tab="faltas" onclick="showPerfilTab('faltas', this)">
                    ğŸ“… Faltas
                </button>
                <button class="perfil-tab" data-tab="horarios" onclick="showPerfilTab('horarios', this)">
                    ğŸ• HorÃ¡rios
                </button>
            </div>

            <div id="perfil-notas" class="perfil-content active">
                <div class="perfil-header">
                    <h2>ğŸ“Š Minhas Notas</h2>

                    <div class="export-buttons">
                        <button onclick="exportarNotas('pdf')" class="btn-export">
                            ğŸ“„ Exportar PDF
                        </button>
                        <button onclick="exportarNotas('excel')" class="btn-export">
                            ğŸ“Š Exportar Excel
                        </button>
                    </div>
                </div>

                <div class="notas-grid">
                    {% if notas %}
                        {% for nota in notas %}
                        <div class="disciplina-card">
                            <h3>{{ nota.disciplina }}</h3>
                            <div class="notas-detalhes">
                                <div class="nota-item">
                                    <span class="nota-label">VA1:</span>
                                    <span class="nota-valor">{{ nota.va1 }}</span>
                                </div>
                                <div class="nota-item">
                                    <span class="nota-label">VA2:</span>
                                    <span class="nota-valor">{{ nota.va2 }}</span>
                                </div>
                                <div class="nota-item">
                                    <span class="nota-label">VA3:</span>
                                    <span class="nota-valor">{{ nota.va3 }}</span>
                                </div>
                                <div class="nota-item media">
                                    <span class="nota-label">MÃ©dia:</span>
                                    <span class="nota-valor {% if nota.media >= 6.0 %}aprovado{% else %}reprovado{% endif %}">
                                        {{ nota.media }}
                                    </span>
                                </div>
                            </div>
                            <div class="situacao-badge {{ nota.situacao|lower }}">
                                {{ nota.situacao }}
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-data">ğŸ“­ Nenhuma nota registrada ainda.</p>
                    {% endif %}
                </div>
            </div>

            <div id="perfil-faltas" class="perfil-content">
                <h2>ğŸ“… Controle de Faltas</h2>

                <div class="faltas-grid">
                    {% if faltas %}
                        {% for falta in faltas %}
                        <div class="disciplina-card">
                            <h3>{{ falta.disciplina }}</h3>
                            <div class="faltas-detalhes">
                                <div class="falta-item">
                                    <span class="falta-label">Total de Faltas:</span>
                                    <span class="falta-valor {% if falta.total_faltas > 12 %}alerta{% endif %}">
                                        {{ falta.total_faltas }}
                                    </span>
                                </div>
                                <div class="falta-item presenca">
                                    <span class="falta-label">PresenÃ§a:</span>
                                    <span class="falta-valor {% if falta.percentual_presenca < 75 %}alerta{% endif %}">
                                        {{ falta.percentual_presenca }}%
                                    </span>
                                </div>
                            </div>
                            {% if falta.percentual_presenca < 75 %}
                            <div class="alerta-box">
                                âš ï¸ AtenÃ§Ã£o! VocÃª estÃ¡ abaixo do limite de 75% de presenÃ§a.
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-data">ğŸ“­ Nenhum registro de faltas ainda.</p>
                    {% endif %}
                </div>
            </div>

            <div id="perfil-horarios" class="perfil-content">
                <h2>ğŸ• HorÃ¡rios de Aula</h2>
                <p class="horarios-info">ğŸ“ Dados sincronizados do Portal Lyceum</p>

                <div class="horarios-grid">
                    {% for dia, aulas in horarios_aulas.items() %}
                    <div class="dia-card">
                        <h3>{{ dia }}</h3>
                        <div class="aulas-lista">
                            {% for aula in aulas %}
                            <div class="aula-item">
                                <div class="aula-horario">â° {{ aula.horario }}</div>
                                <div class="aula-disciplina">ğŸ“š {{ aula.disciplina }}</div>
                                {% if aula.local %}
                                <div class="aula-local">ğŸ“ {{ aula.local }}</div>
                                {% endif %}
                                {% if aula.professor %}
                                <div class="aula-professor">ğŸ‘¨â€ğŸ« {{ aula.professor }}</div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                {% if not horarios_aulas %}
                <div class="no-data-card">
                    <p>ğŸ“­ Nenhum horÃ¡rio encontrado.</p>
                    <p>Clique em <strong>Sincronizar Lyceum</strong> no topo da pÃ¡gina para baixar seus horÃ¡rios.</p>
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    <div id="createPostModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeCreatePostModal()">Ã—</span>
            <h2>â• Criar Novo Post</h2>
            <p class="modal-subtitle">Compartilhe com <strong id="modalCursoName">a comunidade</strong></p>

            <div class="modal-form">
                <input type="hidden" id="postCurso">

                <div class="modal-form-group">
                    <label for="postTipo">Tipo de Post</label>
                    <select id="postTipo" required>
                        <option value="projeto">ğŸ“Œ Projeto</option>
                        <option value="duvida">â“ DÃºvida</option>
                        <option value="discussao">ğŸ’¡ DiscussÃ£o</option>
                    </select>
                </div>

                <div class="modal-form-group">
                    <label for="postTitulo">TÃ­tulo</label>
                    <input type="text" id="postTitulo" placeholder="Digite o tÃ­tulo..." required maxlength="100">
                </div>

                <div class="modal-form-group">
                    <label for="postConteudo">ConteÃºdo</label>
                    <textarea id="postConteudo" placeholder="Escreva o conteÃºdo do post..." required maxlength="1000" rows="6"></textarea>
                </div>

                <div class="modal-form-group">
                    <label for="postTags">ğŸ·ï¸ Tags (separadas por vÃ­rgula)</label>
                    <input type="text" id="postTags" placeholder="Ex: python, ia, machine-learning">
                    <small style="color: var(--gray); font-size: 12px;">
                        Tags ajudam outros alunos a encontrar seu post
                    </small>
                </div>

                <div class="modal-actions">
                    <button onclick="closeCreatePostModal()" class="modal-btn-cancel">Cancelar</button>
                    <button onclick="createPost()" class="modal-btn-create">Publicar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="eventModal" class="modal">
        <div class="modal-evento-content">
            <span class="modal-close" onclick="closeEventModal()">Ã—</span>
            <h2>ğŸ“… Adicionar Evento Pessoal</h2>

            <div class="modal-form">
                <div class="modal-form-group">
                    <label for="eventoTitulo">TÃ­tulo do Evento</label>
                    <input type="text" id="eventoTitulo" placeholder="Ex: Estudar para prova de IA" required>
                </div>

                <div class="modal-form-group">
                    <label for="eventoDescricao">DescriÃ§Ã£o (opcional)</label>
                    <textarea id="eventoDescricao" placeholder="Detalhes do evento..." rows="3"></textarea>
                </div>

                <div class="modal-form-row">
                    <div class="modal-form-group">
                        <label for="eventoData">Data</label>
                        <input type="date" id="eventoData" required>
                    </div>

                    <div class="modal-form-group">
                        <label for="eventoHora">Hora (opcional)</label>
                        <input type="time" id="eventoHora">
                    </div>
                </div>

                <div class="modal-form-group">
                    <label for="eventoTipo">Tipo de Evento</label>
                    <select id="eventoTipo">
                        <option value="pessoal">ğŸ“ Pessoal</option>
                        <option value="estudo">ğŸ“š Estudo</option>
                        <option value="trabalho">ğŸ’¼ Trabalho</option>
                        <option value="lazer">ğŸ® Lazer</option>
                    </select>
                </div>

                <div class="modal-form-group">
                    <label>Cor do Evento</label>
                    <div class="color-picker">
                        <div class="color-option selected" data-color="#4a90e2" onclick="selectColor(this)" title="Azul"></div>
                        <div class="color-option" data-color="#e74c3c" onclick="selectColor(this)" title="Vermelho"></div>
                        <div class="color-option" data-color="#2ecc71" onclick="selectColor(this)" title="Verde"></div>
                        <div class="color-option" data-color="#f39c12" onclick="selectColor(this)" title="Laranja"></div>
                        <div class="color-option" data-color="#9b59b6" onclick="selectColor(this)" title="Roxo"></div>
                        <div class="color-option" data-color="#1abc9c" onclick="selectColor(this)" title="Turquesa"></div>
                        <div class="color-option" data-color="#e91e63" onclick="selectColor(this)" title="Rosa"></div>
                        <div class="color-option" data-color="#34495e" onclick="selectColor(this)" title="Cinza"></div>
                    </div>
                </div>

                <div class="modal-form-group">
                    <label for="eventoAlerta">
                        <input type="checkbox" id="eventoAlerta" onchange="toggleAlertaMinutos()">
                        Ativar alerta
                    </label>
                </div>

                <div id="alertaMinutosGroup" class="modal-form-group" style="display: none;">
                    <label for="alertaMinutos">Minutos antes do alerta</label>
                    <input type="number" id="alertaMinutos" value="30" min="1" max="1440">
                </div>

                <div class="modal-actions">
                    <button onclick="closeEventModal()" class="modal-btn-cancel">Cancelar</button>
                    <button onclick="createEvent()" id="btnCreateEvent" class="modal-btn-create">Criar Evento</button>
                </div>
            </div>
        </div>
    </div>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>

    <script>
        var darkMode = JSON.parse('{{ dark_mode|tojson }}');
    </script>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>